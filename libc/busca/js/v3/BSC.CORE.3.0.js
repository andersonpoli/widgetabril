/**
* BSC libs version 3.0
* Owner: Abril Search Team
* Last build:2014-03-14 14:50
**/
var debug=0;debug?BSC.extend(BSC,console):BSC.log=function(){return!1},function(){"use strict";function a(a){return Array.prototype.slice.call(a)}BSC.core={version:{"BSC Core":"3.0"},keyword:!1,resultObj:!1,waitBSCContainer:!1,prod:"false",ajaxMode:!1,context:"http://busca.abril.com.br/public/search/v2/",servlet:"",path:"/documentos",actualPage:1,hits:10,useDescription:!1,referrer:"",regularParams:[],navParams:[],fqParams:[],sParams:[],beforeList:[],beforePrintList:[],afterList:[],configureUserParams:"",insertFields:!1,target:{container:"#bsc_container",content:"#bsc_resultado",paginate:"#bsc_paginador",found:"#bsc_info",didYouMean:"#bsc_ddm",ajax:".bsc_ajax",bread:"#bsc_breadcrumb"},tmpl:{foundResults:'<div class="resultsFind">Foram encontrados <b>[res]</b> resultados para  <b>[termo]</b> </div><div  class="resultsExib">exibindo [x] a  [y] </div>',bread:'<div><a href="[link]&origembusca=bsc" class="[class]">[value]</a></div>',result:'<div class="bsc_resultado_doc">[preview]<div class="bsc_resultado_titulo"><a href="[link]">[title]</a></div><div class="bsc_resultado_link"><a href="[link]">[linkTXT]</a></div><div class="bsc_resultado_descricao">[description]</div>[date][similar] [geo][tags]</div>',preview:'<div class="bsc_resultado_preview"><img src="[preview]" alt="[title]" title="[title]"/></div>',similar:'<div class="bsc_resultado_similar bsc_ajax"><a href="?&[similar]&origembusca=bsc">Resultados similares</a></div>',date:'<div class="bsc_resultado_date">publicado em [date]</div>',generic:"[val]",link:'<a href="[url]"> [val] </a>',linkButton:'<a href="[url]" class="bsc_pag_[val] bsc_ajax [current]"> [val] </a>',related:'<div id="bsc_related"><h3>Pesquisas relacionadas a <b>[word]</b></h3>[wordlist]</div>',imageSearch:{result:'<div class=\'bsc_resultado_cont\'><div class="out"><div class="bsc_dados"><div class="int"><span>[alt][site][size]</span></div></div></div><div class=\'bsc_resultado_img\'><a href="[link]"><img src="[img]" border="0" class="imgSearch"></a></div></div>'},tags:{path:"",separator:" | ",template:'<li><a href="[url]">[value]</a></li>',container:"<ul>Tags: [content]</ul>",normalize:!1},paginate:{numberOfPages:10,next:' <a class="bsc_prox  bsc_ajax" href="[url]">pr&oacute;ximo</a> ',prev:' <a class="bsc_ant  bsc_ajax" href="[url]"> anterior</a> ',pageAtual:"bsc_actual",paginator:"[prev] [paginator] [next]"}},maxChars:{title:65,description:165,link:100},msg:{wait:"",notFound:"Nenhum resultado foi encontrado para <b>[termo]</b><br><br><div class='err'>&bull; Certifique-se de que todas as palavras estejam escritas corretamente.<br>&bull; Tente palavras-chave diferentes.<br>&bull; Tente palavras-chave mais gen&eacute;ricas.<br></div>",error:"N&atilde;o foi poss&iacute;vel realizar a busca. Por favor, tente novamente",didYouMean:'Voc&ecirc; quis dizer <a href="?qu=[termo]">[termo]</a> ?',emptyKeyword:"Digite no box o termo que deseja encontrar"},initConfig:function(){var a=this.getUrlParamValue("pg"),b=this.getUrlParamValue("qu");try{b=decodeURI(b)}catch(c){b=unescape(b)}this.keyword=b,this.actualPage=""===a?1:parseInt(a,10),this.configureUserParams(),this.execute(this.beforeList),this.search()},execute:function(a){for(var b=a.length,c=0;b>c;)a[c](),c++},before:function(a){this.beforeList.push(a)},after:function(a){this.afterList.push(a)},beforePrint:function(a){this.beforePrintList.push(a)},ajaxModeOn:function(){return BSC.ajaxMode?(BSC.after(function(){BSC.buttonAjaxConfigure()}),BSC.ajaxTimer=setInterval(function(){BSC.place!=location.href&&(BSC.place=location.href,BSC.initConfig())},10),void(BSC.ajaxModeOn=function(){return!1})):(this.ajaxModeOn=function(){return!1},!1)},start:function(a){return 0===$(BSC.target.content).size()&&BSC.waitBSCContainer?(BSC.listener(a),!1):(BSC.configureUserParams=a,void BSC.initConfig())},listener:function(a){BSC.timer=setInterval(function(){var b=document.getElementById("bsc_resultado");null!==b&&(BSC.configureUserParams=a,BSC.initConfig(),clearInterval(BSC.timer),BSC.listener=function(){return!1})},0)},requestContent:function(a){return this.resultObj=a,this.totalResults=a.total_results,this.execute(this.beforePrintList),this.ajaxModeOn(),this.print(),this.execute(this.afterList),this.executeAfter(),a},getBasicParams:function(){var a=BSC.keyword.replace(/\?/g,"\\?"),b="?&q="+BSC.keywordEncoder(a)+"&mfl.content="+BSC.maxChars.description+"&mfl.title="+BSC.maxChars.title+"&pg="+BSC.actualPage+"&h="+BSC.hits+"&callback=BSC.requestContent&hl=true&clientversion=bsc3&origembusca=bsc&spell=true";return BSC.fqParams.push("title:[* TO *]"),b},requestQuery:function(){var a=BSC.imageSearch?"abril-imagesearch":BSC.servlet,b=BSC.context+a+BSC.path;return b+=BSC.getBasicParams(),-1!=BSC.keyword.indexOf("docId:")||(b+="&"+BSC.navParams.join("&"),BSC.regularParams.length>0&&(b+="&"+BSC.regularParams.join("&"),BSC.log(BSC.regularParams.toString())),BSC.imageSearch&&BSC.servlet&&BSC.fqParams.push("website-meta:"+BSC.servlet),b+="&fq="+BSC.fqParams.join(" AND "),BSC.log(BSC.fqParams.toString()),BSC.sParams.length>0&&(b+="&s="+BSC.sParams.join("")),b+="&sp="+encodeURIComponent(window.location.href)),b},search:function(){if(""===BSC.keyword)return $(this.target.content).html(this.msg.emptyKeyword),!1;var a=this.requestQuery();this.loadScript(a,function(){}),this.fqParams=[],this.regularParams=[],this.sParams=[]},keywordEncoder:function(a){var b=new RegExp("([!~'()])","g"),c=encodeURIComponent(a);return c=c.replace(b,function(a,b){return escape(b)})},getReferer:function(){var a="";try{var b="bsc_ref=",c=encodeURIComponent(document.referrer),d=document.cookie,e=new RegExp(b+"|;$","g"),f=location.host+location.pathname+"?qu="+encodeURI(BSC.getUrlParamValue("qu")),g=d.match(b);(null===g||""===c||-1==document.referrer.indexOf(f))&&(document.cookie=b+c+";"),a=document.cookie.match(b+".[^;]*").toString().replace(e,"")}catch(h){a="none"}return a},parser:function(a){var b=a.documents,c=b.length,d=this.insertFields;BSC.referrer=this.getReferer(),d||(this.extraFields=function(a){return a});for(var e=0,f=[];c>e;e++)f.push(this.parserResult(b[e],e));return f.join(" ")},parseSimilarity:function(a){return a},normalize:function(a){return a=a.toLowerCase(),a=a.replace(/ |%20/g,"-"),a=this.removeAccents(a)},parseFieldsTags:function(a,b,c){var d,e=this.tmpl.generic,f=this.tmpl.tags,g=this.tmpl.tags.template,h=BSC.tmpl.tags.normalize;if("tag"==c){if(a.constructor!==Array)return d=h?this.normalize(a):a,e=g.replace(/\[url\]/,f.path+d).replace(/\[value\]/,a),e=this.tmpl.tags.container.replace("[content]",e);for(var i,j=[],k=a.length,l=0;k>l;)i=a[l],d=h?this.normalize(i):i,i=g.replace(/\[url\]/,f.path+d).replace(/\[value\]/,i),j.push(i),l++;a=j.join(f.separator),a=this.tmpl.tags.container.replace("[content]",a)}else if("default"!=c){var m=new RegExp("\\["+b+"\\]","g");a=c.replace(m,a)}return e=e.replace(/\[generic\]/g,b).replace(/\[val\]/g,a)},extraFields:function(a,b){var c,d,e=BSC.insertFields,f=[];for(var g in e)if(e.hasOwnProperty(g)&&(c=-1==g.indexOf("htmltag")?g+"-meta":g,d="undefined"==typeof b[c]?b[g]:b[c],"undefined"!=typeof d)){var h=BSC.parseFieldsTags(d,g,e[g]),i=new RegExp("\\["+g+"\\]","g");a=a.replace(i,h)}return a=a.replace(/\[extras\]/g,f.join(" "))},formatDate:function(a){return a=a.split("T")[0].split("-").reverse().join("/")},specialFunctions:[],getSpecialFunctions:function(a,b){for(var c=this.specialFunctions,d=c.length;d--;)a=c[d](a,b);return a},parseRegExp:/\[([a-zA-Z\-\_]+)\]/g,replacer:function(a,b,c,d){return d in b?b[d](a):(d+"-meta"in a&&(d+="-meta"),d in a?a[d]:"")},parserMap:{linkTXT:function(a){var b=a.url;return b.length<BSC.maxChars.link?b:b.substring(0,BSC.maxChars.link)+"..."},preview:function(a){var b="undefined"==typeof a["thumbnail-meta"]?a["preview-meta"]:a["thumbnail-meta"];if(b="undefined"==typeof b?a.preview:b,"undefined"==typeof b)return"";var c=function(a){return"undefined"==typeof a?"":a};return BSC.tmpl.preview.replace(BSC.parseRegExp,BSC.replacer.curry(a,{preview:c.curry(b)}))},description:function(a){var b=BSC.useDescription===!0?a["description-meta"]:a.highlight_content;return b="undefined"==typeof b?a.content:b,b="undefined"==typeof b?"":b,b.constructor==Array&&(b=b.toString()),b=b.replace(/<\/?\.\.\./g,"...")+"</b>"},date:function(a){return"undefined"==typeof a.date?"":BSC.tmpl.date.replace(/\[date\]/g,BSC.formatDate(a.date))},site:function(a){return'<span class="bsc_website">'+a["website-meta"]+"</span>"},size:function(a){return'<span class="bsc_size">'+a.height+"x"+a.width+"</span>"},alt:function(a){return"undefined"==typeof a.alt?'<span class="bsc_alt">'+a.title+"</span>":'<span class="bsc_alt">'+a.alt+"</span>"},img:function(a){return"undefined"==typeof a.image_thumb?"":a.image_thumb.replace(/\{imageHost\}/,"msalx.busca.abril.com.br").replace(/\{size\}/,"CnWuL")},link:function(a){return a.image?a.image:a.url}},parserResult:function(a,b){var c=this.tmpl,d=BSC.imageSearch?c.imageSearch.result:c.result;return d=this.extraFields(d,a),d=this.getSpecialFunctions(d,a),d=d.replace(BSC.parseRegExp,BSC.replacer.curry(a,BSC.parserMap)),d=this.metrics(d,b,a.title)},metrics:function(a,b,c){var d=(this.actualPage,new RegExp("href=[\"']+[^\"']+[\"']","g")),e=a.match(d);null===e&&(e=[]);for(var f=e.length;f--;){var g=e[f],h=g.replace(/href=|[\"\']/g,"");-1==h.indexOf("http://")&&(h="http://"+location.host+location.pathname+h);var i="http://"+BSC.environment+"busca.abril.com.br/statistic?pg="+this.actualPage+"&rk="+(b+1)+"&site="+location.host+"&qu="+encodeURIComponent(BSC.keyword.toLowerCase().replace(/[\"\'(%22|%27)]/g,"%22"))+"&url="+encodeURIComponent(h)+"&t="+encodeURIComponent(c.replace("[\"'(%22|%27)]",""))+"&ref="+BSC.referrer+"&origembusca=bsc&us="+BSC.userId+"&sp="+encodeURIComponent(window.location.href);i='href="'+i+'"',a=a.replace(g,i)}return a},paginate:function(){var a=this.actualPage,b=this.tmpl.paginate,c=this.resultObj,d=c.total_results,e=Math.ceil(d/this.hits),f=b.numberOfPages,g=Math.floor(b.numberOfPages/2),h=a-g,i=a+g-1,j="",k="",l=new RegExp("&?pg="+this.getUrlParamValue("pg"),"g"),m=location.href.split("?")[1];m="undefined"==typeof m?"#?"+location.href.split("#")[1]:"?"+m,m=m.replace(l,"");var n="http://"+location.host+location.pathname+m,o="";n=this.ajaxMode?n.replace(/\#\?|\?|\#/g,"#?"):n.replace(/\#\?|\#/g,"?"),g>=a&&d>f?(h=1,i=f):i>=e-g&&d>f?(i=e,h=i-f):f>e&&(h=1,i=e),1>h&&(h=1),i>e&&(i=e),a>1&&(j=b.prev.replace(/\[url\]/,n+"&pg="+(a-1))),e>a&&(k=b.next.replace(/\[url\]/,n+"&pg="+(a+1)));for(var p=h;i>=p;p++)o+=this.buttonGenerate(p,n);return b.paginator.replace(/\[paginator\]/,o).replace(/\[prev\]/,j).replace(/\[next\]/,k)},foundResults:function(a){var b=a.total_results,c=this.tmpl.foundResults,d=this.actualPage*this.hits,e=d-this.hits+1;return d=d>b?b:d,c=c.replace(/\[res\]/g,b).replace(/\[termo\]/g,decodeURIComponent(encodeURIComponent(this.keyword))).replace(/\[x\]/g,e).replace(/\[y\]/g,d)},buttonGenerate:function(a,b){var c=this.tmpl.linkButton,d=this.actualPage===a?"bsc_current_page":"";return c=c.replace(/\[url\]/g,b+"&pg="+a).replace(/\[val\]/g,a).replace(/\[current\]/g,d)},buttonAjaxConfigure:function(){return BSC.ajaxMode?void $(BSC.target.ajax).click(function(){$("html, body").animate({scrollTop:0},0)}):!1},didYouMean:function(a){var b=this.msg.didYouMean,c=a.spelling_suggestion.toString();return b=""!==c?b.replace(/\[termo\]/g,c):""},printElems:{boxValue:function(){$(".qu").val(decodeURIComponent(encodeURIComponent(BSC.keyword)))},results:function(a){var b=BSC.parser(a);if(""!==b)$(BSC.target.content).html(b);else{var c=BSC.msg.notFound.replace(/\[termo\]/,decodeURIComponent(BSC.keyword));$(BSC.target.content).html(c)}},found:function(a,b){b&&$(BSC.target.found).html(a)},paginate:function(){var a=BSC.paginate();$(BSC.target.paginate).html(a),$(".bsc_pag_"+this.actualPage).removeAttr("href").addClass(BSC.tmpl.paginate.pageAtual)},didYouMean:function(a){$(BSC.target.didYouMean).html(a).show()}},print:function(){var a=this.resultObj,b=this.foundResults(a),c=this.didYouMean(a);this.printElems.boxValue(),this.printElems.results(a),this.printElems.found(b,parseInt(a.total_results,10)),this.printElems.paginate(),this.printElems.didYouMean(c),$("body").show()}},Function.prototype.curry=function(){if(arguments.length<1)return this;var b=this,c=a(arguments);return function(){return b.apply(this,c.concat(a(arguments)))}},BSC.extend(BSC.version,BSC.core.version),BSC.extend(BSC,BSC.core),delete BSC.core}();